<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rolecreate</title>

    <!-- BOOTSTRAP STYLES-->
    <link th:href="@{/css/bootstrap.css}" rel="stylesheet" />
    <!-- FONTAWESOME STYLES-->
    <link th:href="@{/css/font-awesome.css}" rel="stylesheet" />
    <!--CUSTOM BASIC STYLES-->
    <link th:href="@{/css/basic.css}" rel="stylesheet" />
    <!--CUSTOM MAIN STYLES-->
    <link th:href="@{/css/custom.css}" rel="stylesheet" />
    <!--My Role Table Styles-->
    <link th:href="@{/css/role-table.css}" rel="stylesheet"/>
    <!-- GOOGLE FONTS-->
    <!--
    <link th:href='@{https://fonts.useso.com/css?family=Open+Sans}' rel='stylesheet' type='text/css' />
    -->
</head>
<body>
    <div id="wrapper">
        <div th:replace="~{topbar/topbar::topbar}"></div>
        <!-- /. NAV TOP  -->
        <div th:replace="~{sidebar/side-bar::sidebar}"></div>
        <!-- /. NAV SIDE  -->
        <div id="page-wrapper">
            <div id="page-inner">
                <!-- /. ROW  -->
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="page-head-line">Data Create</h1>
                        <h1 class="page-subhead-line">创建你的角色</h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div id="baseInfoTable"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-5">
                            <div id="roleElementTable"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div id="roleElementTable_ext"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="roleSkillCreateTable"></div>
                    </div>
                </div>
                <!-- /. ROW  -->
            </div>
            <!-- /. PAGE INNER  -->
        </div>
    </div>

    <!-- JQUERY SCRIPTS -->
    <script th:src="@{/js/jquery-1.10.2.js}"></script>
    <!-- BOOTSTRAP SCRIPTS -->
    <script th:src="@{/js/bootstrap.js}"></script>
    <!-- METISMENU SCRIPTS -->
    <script th:src="@{/js/jquery.metisMenu.js}"></script>
    <!-- CUSTOM SCRIPTS -->
    <script th:src="@{/js/custom.js}"></script>
    <!-- Role Info Table Generate-->
    <script th:src="@{/js/roleCreate.js}"></script>
</body>

<script type="text/javascript" th:inline="javascript"></script>

<script>
    let roleId = "";
    $(document).ready(function () {
        $("#Data_Create_a").addClass("active-menu");
        //getRoleId();
        setRoleBaseInfo();
        setRoleElement();
        setRoleSkill();
    })

    function setRoleBaseInfo(){
        let gender = "";
        let baseInfoTableHtml = "<div class=\"panel panel-default\">"
            +"<div class=\"panel-heading\">调查员信息</div>"
            +"<div class=\"panel-body\">"
            +"<div class=\"table-responsive\">"
            +"<table class=\"table table-striped table-bordered table-hover\">"
            +"<tbody>"
            +"<tr>"
            +"<th class='roleBaseInfoCol'>姓名</th>"
            +"<th class='roleBaseInfoContent changeable varchar maxLength_40', id='th_roleName'><input><text> </text></input></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleBaseInfoCol'>玩家</th>"
            +"<th class='roleBaseInfoContent' id='th_userName'><input><text> </text></input></th>"
            +"<th class='roleBaseInfoCol Era'>年代</th>"
            +"<th class='roleBaseInfoContent changeable Era', id='th_era'><input list='Era_Datalist'><text> </text></input></th>"
            +"<datalist id='Era_Datalist'><option value='1920s'><option value='现代'><option value='自定义'></datalist>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleBaseInfoCol'>职业</th>"
            +"<th class='roleBaseInfoContent', id='th_roleJobName'><input><text> </text></input></th>"
            +"<th class='roleBaseInfoCol'>职业序号</th>"
            +"<th class='roleBaseInfoContent changeable Integer', id='th_roleJobId'><input><text> </text></input></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleBaseInfoCol'>年龄</th>"
            +"<th class='roleBaseInfoContent changeable Integer', id='th_roleAge'><input onchange = 'changeElement()'><text> </text></input></th>"
            +"<th class='roleBaseInfoCol'>性别</th>"
            +"<th class='roleBaseInfoContent changeable Gender', id='th_gender'><input><text> </text></input></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleBaseInfoCol'>住地</th>"
            +"<th class='roleBaseInfoContent changeable varchar maxLength_60', id='th_roleHomeAddress'><input><text> </text></input></th>"
            +"<th class='roleBaseInfoCol'>故乡</th>"
            +"<th class='roleBaseInfoContent changeable varchar maxLength_40', id='th_roleHomeTown'><input><text> </text></input></th>"
            +"</tr>"
            +"</tbody>"
            +"</table>"
            +"<text class='roleInfoEditBut' id='randomDataButton'>随机职业</text>"
            +"</div>"
            +"</div>"
            +"</div>";
        baseInfoTableHtml+="</div></div>";
        $("#baseInfoTable").html(baseInfoTableHtml);

        $("#randomDataButton").click(function (e) {
            let button = document.getElementById("randomDataButton");
            let inputs = document.getElementsByClassName("roleBaseInfoContent");
            //4  jobID
            inputs[4].innerHTML = "<th class='roleBaseInfoContent changeable Integer', id='th_roleJobId'><input value='" + Math.floor(Math.random() * 100 + 1) + "'/></th>"
        })


    }

    function setRoleElement(){
        //console.log(data);
        let roleElementHtml = "<div class=\"panel panel-default\">"
            +"<div class=\"panel-heading\" id='elementcount'>属性(合计:"+0+")[含幸运:"+0+"]</div>"
            +"<div class=\"panel-body\">"
            +"<div class=\"table-responsive\">"
            +"<table class=\"table table-striped table-bordered table-hover\">"
            +"<tbody>"
            +"<tr>"
            +"<th class='roleElementColumn'>力量</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementColumn'>敏捷</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>体质</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementColumn'>外貌</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>体型</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementColumn'>智力</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>意志</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementColumn'>教育</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>移动力</th>"
            +"<th class='roleElementContent changeable Integer'><text> 8 </text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementColumn'>幸运</th>"
            +"<th class='roleElementContent changeable Integer'><input type='number' min='0' max='100' step='5' onchange = 'changeElement()'></input></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"<th class='roleElementContent'><text></text></th>"
            +"</tr>"
            +"</tbody>"
            +"</table>"
            +"<text class='roleInfoEditBut' id='roleElementEditButton'>随机数据</text>"
            +"</div>"
            +"</div>"
            +"</div>";
        $("#roleElementTable").html(roleElementHtml)

        $("#roleElementEditButton").click(function (e) {
            let element = document.getElementById("elementcount");
            let inputs = document.getElementsByClassName("roleElementContent changeable");
            var ele_number = new Array(10);
            var count = 0;
            for(let i = 0; i < 10; i++){
                ele_number[i]=0;
                if(i==8)continue;//move
                if(inputs[i].classList.contains("changeable")){
                    //console.log(inputs[i].innerHTML);
                    if(inputs[i].classList.contains("Integer")){
                        //console.log(inputs[i].innerText);
                        ele_number[i]= 5*(Math.floor(Math.random() * 6 + 1)+Math.floor(Math.random() * 6 + 1)+Math.floor(Math.random() * 6 + 1));
                        inputs[i].innerHTML="<th class='roleElementContent changeable Integer'><input type='number' value='" + ele_number[i] + "' min='0', max='100' step='5' onchange = 'changeElement()'/></th>"
                        count+=ele_number[i];
                        //console.log(inputs[i].innerHTML);
                    }
                }
            }
            changeElement();
        })


        let roleElementExtHtml = "<div class=\"panel panel-default\">"
            +"<div class=\"panel-heading\">调查员状态</div>"
            +"<div class=\"panel-body\">"
            +"<div class=\"table-responsive\">"
            +"<table class=\"table table-striped table-bordered table-hover\">"
            +"<tbody>"
            +"</tbody>"
            +"<tr>"
            +"<th class='roleElementColumn'>体力</th>"
            +"<th class='roleStatusContent changeable Integer UpperBound'><input type='number' min='0' max='0'><text>  </text></input>/<text> 0 </text></th>"
            +"<th class='roleElementColumn'>理智</th>"
            +"<th class='roleStatusContent changeable Integer UpperBound'><input type='number' min='0' max='0'><text>  </text></input>/<text> 0 </text></th>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>魔法</th>"
            +"<th class='roleStatusContent changeable Integer UpperBound'><input type='number' min='0' max='0'><text>  </text></input>/<text> 99 </text></th>"
            +"<th class='roleElementColumn'>身体状态</th>"
            +"<th class='roleStatusContent changeable physicalStatus'><input list='physicalStatus_Datalist' id='physicalStatusInput'><text> </text></input></th>"
            +"<datalist id='physicalStatus_Datalist'><option value='健康'><option value='轻伤'><option value='重伤'><option value='昏迷'><option value='濒死'><option value='死亡'></datalist>"
            +"</tr>"
            +"<tr>"
            +"<th class='roleElementColumn'>精神状态</th>"
            +"<th class='roleStatusContent changeable mentalStatus'><input list='mentalStatus_Datalist' id='mentalStatusInput'><text> </text></input></th>"
            +"<datalist id='mentalStatus_Datalist'><option value='神志清醒'><option value='临时性疯狂'><option value='不定性疯狂'></datalist>"
            +"</tr>"
            +"</table>"
            +"</div>"
            +"</div>"
            +"</div>";
        $("#roleElementTable_ext").html(roleElementExtHtml);
    }

    function changeElement() {
        let element = document.getElementById("elementcount");
        let inputs = document.getElementsByClassName("roleElementContent changeable");
        let ageEle = document.getElementById("th_roleAge");
        let inputs2 = document.getElementsByClassName("roleStatusContent changeable");
        let age = Number(ageEle.children[0].value);
        let move = 8;
        let str = Number(inputs[0].children[0].value),dex= Number(inputs[1].children[0].value),siz= Number(inputs[4].children[0].value);
        let con = Number(inputs[2].children[0].value),pow =Number(inputs[6].children[0].value);
        let HP = Math.floor((siz+con)/10),MP=Math.floor(pow/5),SAN=pow;

        var count = 0;
        for(let i = 0; i < 10; i++){
            if(i==8)continue;//move
            if(inputs[i].classList.contains("changeable")){
                //console.log(inputs[i].innerHTML);
                if(inputs[i].classList.contains("Integer")){
                    count = count + Number(inputs[i].children[0].value);
                    //console.log(Number(inputs[i].children[0].value));
                }
            }
        }
        for(let i = 0; i < inputs2.length; i++) {
            if (inputs2[i].classList.contains("changeable")) {
                if (inputs2[i].classList.contains("Integer")) {
                    if (inputs2[i].classList.contains("UpperBound")) {
                        if(i==0) inputs2[i].innerHTML = "<th class='roleStatusContent changeable Integer UpperBound'><input type='number' value='" + HP + "' min='0', max='100'</input>/<text> " + HP + " </text></th>";
                        if(i==1) inputs2[i].innerHTML = "<th class='roleStatusContent changeable Integer UpperBound'><input type='number' value='" + SAN + "' min='0', max='100'</input>/<text> " + SAN + " </text></th>";
                        if(i==2) inputs2[i].innerHTML = "<th class='roleStatusContent changeable Integer UpperBound'><input type='number' value='" + MP + "' min='0', max='100'</input>/<text> " + MP + " </text></th>";
                    }
                }
            }
        }

        if(str>siz && dex>siz)move = 9;
        else if(str<siz && dex<siz)move = 7;
        if(age>=40&&age<50)move-=1;
        else if(age>=50&&age<60)move-=2;
        else if(age>=60&&age<70)move-=3;
        else if(age>=70&&age<80)move-=4;
        else if(age>=80)move-=5;
        //move
        inputs[8].innerHTML="<th class='roleElementContent changeable Integer'><text>" + move + "</text></th>"
        //total
        var luck = Number(inputs[9].children[0].value);
        element.innerHTML = "<div class=\"panel-heading\" id='element'>属性(合计:" +(count - luck)+ ")[含幸运:" +count+ "]</div>"

    }

</script>
</html>